"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e){var t=function(){function e(t){_classCallCheck(this,e),t=t||{},this.callBack={},this.progress=t.progress?t.progress.bind(this):function(){},this.timeOut=t.timeOut||15,this.timeOutCB=t.timeOutCB?t.timeOutCB.bind(this):function(){},this.reset(),this.imgNode=[],this.loadTag()}return _createClass(e,[{key:"load",value:function(e){var t=this,n=this;return new Promise(function(r,i){t.isArrayFn(e)||i(new Error("It's not allow params")),e.length||i(new Error("It's not null")),n.reset(e.length),n.imgList=e,e.forEach(function(e){var i=new Image,o=n._timeOut(e);i.src=e,i.onload=n.onload.bind(t,e,o,r),i.onerror=n.onerror.bind(t,e,o,r)})})}},{key:"loadTag",value:function(){for(var e=this,t=document.getElementsByTagName("img"),n=0,r=t.length;n<r;n++)!function(n,r){if(t[n].attributes["p-src"]){var i=new Image,o=t[n].attributes["p-src"].value,a=e._timeOut(o);i.src=o,i.onload=function(){clearTimeout(a),t[n].src=o}}}(n)}},{key:"_timeOut",value:function(e){var t=this,n=setTimeout(function(){t.timeOutCB({name:e,msg:"load timer"}),clearTimeout(n)},1e3*t.timeOut);return n}},{key:"onload",value:function(e,t,n){clearTimeout(t),this.success.data.push(e),this.progress(++this.flag,this.count),this.complate(n)}},{key:"onerror",value:function(e,t,n){clearTimeout(t),this.err.data.push(e),this.progress(++this.flag,this.count),this.complate(n)}},{key:"complate",value:function(e){this.flag>=this.count&&e(this.success)}},{key:"reset",value:function(e){this.imgList=[],this.flag=0,this.count=e,this.success={code:0,msg:"success",data:[]},this.err={code:-1,msg:"load error",data:[]}}},{key:"isArrayFn",value:function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}}]),e}(),n=function(e,t,n){function r(e){return o.body?e():setTimeout(function(){r(e)})}var i=function e(t){for(var n=s.href,r=a.length;r--;)if(a[r].href===n)return t();setTimeout(function(){e(t)})},o=window.document,a=o.styleSheets,s=o.createElement("link"),n=n||"all";if(s.rel="stylesheet",s.href=e,s.media=n,!t){var u=(o.getElementsByTagName("head")[0]||o.body).childNodes;t=u[u.length-1]}r(function(){t.parentNode.insertBefore(s,t||t.nextSibling)}),s.addEventListener&&s.addEventListener("load",function(e){if(navigator.userAgent.toLowerCase().match(/firefox/)){var n=o.createElement("script");t.parentNode.insertBefore(n,t||t.nextSibling)}}),s.onloadcssdefined=i,i(function(){s.media!==n&&(s.media=n)})},r=function(e,t,n,r){var i=document.createElement("link");if(i.rel="preload",i.href=e,i.as=t||"font",i.type=n||"font/ttf",i.setAttribute("crossorigin","anonymous"),r=r||function(){},!i.relList||!i.relList.supports||!i.relList.supports("preload"))return alert("unsupports: Resource Hints preload"),0;i.addEventListener("load",function(){r()}),document.getElementsByTagName("head")[0].appendChild(i)};e.imageLoad=t,e.cssLoad=n,e.fontLoad=r}((void 0).preload=(void 0).preload||{});